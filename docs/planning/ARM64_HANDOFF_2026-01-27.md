# ARM64 Parity Handoff (2026-01-27)

This is a short, concrete handoff of the current ARM64 parity effort and where it stands.

## Current Branch / Status
- Branch: `feature/arm64-parity`
- Work is being executed step-by-step and reflected in the parity docs after each major change.
- Most recent commits:
  - `fc6dea8` arm64: expand userspace build list for ext2
  - `f5f19fe` arm64: add ext2 disk support for userspace
  - `a3b7eae` arm64: init tty at boot and update plan
  - `13486d9` arm64: enable devptsfs and refresh parity docs
  - `bea6750` arm64: execv/wait4, tcp sockets, ext2 init_shell

## Planning Docs (authoritative)
- `docs/planning/ARM64_FEATURE_PARITY_PLAN.md` (main plan + phased checklist)
- `docs/planning/ARM64_SYSCALL_MATRIX.md` (current syscall parity snapshot)
- `docs/planning/ARM64_SYSCALL_PORTING_CHECKLIST.md` (porting checklist)
- `docs/planning/ARM64_USERPTR_AUDIT.md` (user pointer validation audit)
- `docs/planning/ARM64_MEMORY_LAYOUT_DIFF.md` (ARM64 VA layout notes)

These are kept up to date as parity work progresses.

## What Was Just Completed
- ARM64 execv now supports argv and ext2-backed exec, with test-disk fallback.
- wait4/waitpid wired for ARM64.
- TCP sockets enabled on ARM64 (no longer EAFNOSUPPORT gate).
- devptsfs enabled on ARM64 at boot; TTY subsystem initialized at boot.
- ext2 disk builder now supports ARM64 (`scripts/create_ext2_disk.sh --arch aarch64`).
- ARM64 QEMU script prefers ext2 image if present.
- ARM64 userspace build list expanded to include coreutils + telnetd (best-effort).

## Current Gaps (Still Blocking Full Parity)
- ARM64 userspace binaries installed on ext2 image (coreutils coverage still TBD).
- PTY/TTY behavior unverified under ARM64 userspace load.
- Scheduler/preemption validation under userspace load.
- Memory map + allocator parity (ARM64 still uses bump allocator).
- ARM64 test harness / boot stage parity subset not established.

## How To Continue (Next Concrete Steps)
1) Build ARM64 userspace binaries (best-effort list):
   - `cd userspace/tests && ./build-aarch64.sh`
2) Create ARM64 ext2 image with those binaries:
   - `./scripts/create_ext2_disk.sh --arch aarch64`
3) Boot ARM64 with ext2 image preferred:
   - `./scripts/run-arm64-graphics.sh release`

(Testing not run in this handoff; these are only provided as next steps.)

## Notes / Constraints
- Do not modify Tier 1/Tier 2 prohibited files without explicit approval.
- Avoid adding logging to interrupt/syscall hot paths.
- Keep parity docs updated after each milestone (plan + syscall matrix).

